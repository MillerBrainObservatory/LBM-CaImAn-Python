selector_to_html = {"a[href=\"#change-a-parameter\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2.5. </span>Change a parameter<a class=\"headerlink\" href=\"#change-a-parameter\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#view-the-parameter-differences\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4.2. </span>View the parameter differences<a class=\"headerlink\" href=\"#view-the-parameter-differences\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#view-numerical-results\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">View numerical results<a class=\"headerlink\" href=\"#view-numerical-results\" title=\"Link to this heading\">#</a></h4><p><code class=\"docutils literal notranslate\"><span class=\"pre\">lcp.get_summary_mcorr()</span></code> will use the resulting filepaths to load the <strong>mean</strong> metric statistic, along with the path to the metrics file.</p><p>This gives you an overview of the best results. The metric_path is needed to load larger arrays for plotting that don\u2019t performantly fit into a dataframe cell.</p>", "a[href=\"#run-the-batch-item\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.3.2. </span>Run the batch item<a class=\"headerlink\" href=\"#run-the-batch-item\" title=\"Link to this heading\">#</a></h3><p>If you ever get errors like</p>", "a[href=\"#check-for-errors-in-outputs\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.3.3. </span>Check for errors in outputs<a class=\"headerlink\" href=\"#check-for-errors-in-outputs\" title=\"Link to this heading\">#</a></h3><p>In the table header <strong>outputs</strong>, you should see</p>", "a[href=\"#single-plane-registration\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.3. </span>Single-plane registration<a class=\"headerlink\" href=\"#single-plane-registration\" title=\"Link to this heading\">#</a></h2><p>See the mesmerize-core <a class=\"reference external\" href=\"https://mesmerize-core.readthedocs.io/en/latest/api/functions.html\">utility docs</a> for more information on batch creation.</p><p>We simple need to:</p>", "a[href=\"#using-metadata-to-assign-parameter-values\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2.1. </span>Using metadata to assign parameter values<a class=\"headerlink\" href=\"#using-metadata-to-assign-parameter-values\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">plot_data_with_scalebars</span></code> will give you 3 images, at 5, 10 and 20 um.</p><p>You can use any summary images:</p>", "a[href=\"#find-the-duplicates\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Find the duplicates<a class=\"headerlink\" href=\"#find-the-duplicates\" title=\"Link to this heading\">#</a></h4><p>Before calculating computationally intensive summary registration statistics like correlation and flow, we want to remove duplicates to avoid\nunnessesary computaion.</p><p><code class=\"docutils literal notranslate\"><span class=\"pre\">lcp.drop_duplicates</span></code> will iterate over your dataframe and drop any duplicate results.</p>", "a[href=\"#check-for-errors\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4.5. </span>Check for errors<a class=\"headerlink\" href=\"#check-for-errors\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#scaling-patches-relative-to-neuron-size\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2.2. </span>Scaling patches relative to neuron size<a class=\"headerlink\" href=\"#scaling-patches-relative-to-neuron-size\" title=\"Link to this heading\">#</a></h3><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">generate_patch_view</span></code> function divides the image into patches the same way CaImAn will do internally.</p><p>Increasing / decreasing the <code class=\"docutils literal notranslate\"><span class=\"pre\">target_patch_size</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">overlap_fraction</span></code> parameters to examine the effect of different stride/overlap values displayed in the title.</p>", "a[href=\"#add-an-item-to-the-batch\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.3.1. </span>Add an item to the batch<a class=\"headerlink\" href=\"#add-an-item-to-the-batch\" title=\"Link to this heading\">#</a></h3><p>A \u201cbatch item\u201d consists of:</p>", "a[href=\"#scale-factor-and-gsig-filt\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4.1. </span><code class=\"docutils literal notranslate\"><span class=\"pre\">scale_factor</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">gSig_filt</span></code><a class=\"headerlink\" href=\"#scale-factor-and-gsig-filt\" title=\"Link to this heading\">#</a></h3><p>If you still see non-rigid motion in your movie, we can try increasing the <code class=\"docutils literal notranslate\"><span class=\"pre\">scale_factor</span></code> to increase our patch-size or decrease it.</p><p>More than likely you will want to decrease the scale factor to process more patches.</p>", "a[href=\"#optical-flow\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Optical Flow<a class=\"headerlink\" href=\"#optical-flow\" title=\"Link to this heading\">#</a></h4><p>Optical flow measures the movement of a pixel between two consecutive frames.</p><p>Movement is illustrated as brighter values, with the hue (color) illustrating the direction of movement.</p>", "a[href=\"#merge-metrics-results-with-added-parameters-used-for-grid-search\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Merge metrics results with added parameters used for grid-search<a class=\"headerlink\" href=\"#merge-metrics-results-with-added-parameters-used-for-grid-search\" title=\"Link to this heading\">#</a></h4><p>We used <code class=\"docutils literal notranslate\"><span class=\"pre\">df.caiman.get_param_diffs()</span></code> to get a list of parameters that differ between batch runs, to filter out the parameters common to each item.</p><p>We can add these values as columns to evaluate which parameters led to the desired metric by using <code class=\"docutils literal notranslate\"><span class=\"pre\">add_param_diffs</span></code> with either or both of the result tables we just calculated.</p>", "a[href=\"#plot-residual-flows-and-correlations\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Plot residual flows and correlations<a class=\"headerlink\" href=\"#plot-residual-flows-and-correlations\" title=\"Link to this heading\">#</a></h4><h5>With many batches<a class=\"headerlink\" href=\"#with-many-batches\" title=\"Link to this heading\">#</a></h5>", "a[href=\"#tune-gsig-filt-high-pass-filter\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2.4. </span>Tune <code class=\"docutils literal notranslate\"><span class=\"pre\">gSig_filt</span></code> (high-pass-filter)<a class=\"headerlink\" href=\"#tune-gsig-filt-high-pass-filter\" title=\"Link to this heading\">#</a></h3><p>Use a spatial filter to highlight cells and eliminate low-frequency spatial information (i.e. blood-vessels)</p><p>In the below widget, move the slider at the bottom titled \u2018gSig_filt\u2019 to see if adding a gaussian blur can help highlight neurons and hide blood-vessels.</p>", "a[href=\"#create-or-load-a-batch-set\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.1.1. </span>Create or load a batch set<a class=\"headerlink\" href=\"#create-or-load-a-batch-set\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#data-path-and-batch-setup\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.1. </span>Data path and batch setup<a class=\"headerlink\" href=\"#data-path-and-batch-setup\" title=\"Link to this heading\">#</a></h2><p>We set 2 path variables:</p>", "a[href=\"#apply-the-best-parameters-to-remaining-files\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.6. </span>Apply the \u2018best parameters\u2019 to remaining files<a class=\"headerlink\" href=\"#apply-the-best-parameters-to-remaining-files\" title=\"Link to this heading\">#</a></h2><p>When you decide which parameter set works the best, we keep it and delete the other batch items.</p><p>Remove batch items (i.e. rows) using <code class=\"docutils literal notranslate\"><span class=\"pre\">df.caiman.remove_item(&lt;item_uuid&gt;)</span></code>. This also cleans up the output data in the batch directory.</p>", "a[href=\"#parameters-from-metadata\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2.3. </span>Parameters from metadata<a class=\"headerlink\" href=\"#parameters-from-metadata\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">lcp.params_from_metadata(metadata)</span></code> will calculate sensible defaults for registration (and segmentation).</p><p>Compare the strides / overlaps generated from the <code class=\"docutils literal notranslate\"><span class=\"pre\">generate_patch_view()</span></code> function. If they are significantly different,\nwe recommend you use the defaults for the first run, and tune with the values from your custom set overlap.</p>", "a[href=\"#registration-parameters\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.2. </span>Registration parameters<a class=\"headerlink\" href=\"#registration-parameters\" title=\"Link to this heading\">#</a></h2><p>The parameters are passed <strong>directly</strong> to <code class=\"docutils literal notranslate\"><span class=\"pre\">caiman</span></code>, this means you need to use the same exact names for the parameters and you can use all the parameters that you can use with <code class=\"docutils literal notranslate\"><span class=\"pre\">caiman</span></code> - because it\u2019s just passing them to <code class=\"docutils literal notranslate\"><span class=\"pre\">caiman</span></code>.</p><p>The parameters dict for a mesmerize batch item must have the following structure. Put all the parameters in a dict under a key called <strong>main</strong>. The <strong>main</strong> dict is then fed directly to <code class=\"docutils literal notranslate\"><span class=\"pre\">caiman</span></code>.</p>", "a[href=\"#grid-search-for-best-parameters\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4. </span>Grid-search for best parameters<a class=\"headerlink\" href=\"#grid-search-for-best-parameters\" title=\"Link to this heading\">#</a></h2><h3><span class=\"section-number\">3.4.1. </span><code class=\"docutils literal notranslate\"><span class=\"pre\">scale_factor</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">gSig_filt</span></code><a class=\"headerlink\" href=\"#scale-factor-and-gsig-filt\" title=\"Link to this heading\">#</a></h3><p>If you still see non-rigid motion in your movie, we can try increasing the <code class=\"docutils literal notranslate\"><span class=\"pre\">scale_factor</span></code> to increase our patch-size or decrease it.</p><p>More than likely you will want to decrease the scale factor to process more patches.</p>", "a[href=\"#view-metadata\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.1.3. </span>View metadata<a class=\"headerlink\" href=\"#view-metadata\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">lcp.get_metadata(filepath)</span></code> works on raw scanimage files and files processed through <code class=\"docutils literal notranslate\"><span class=\"pre\">lcp.save_as()</span></code></p>", "a[href=\"#summary-statistics\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.5.1. </span>Summary statistics<a class=\"headerlink\" href=\"#summary-statistics\" title=\"Link to this heading\">#</a></h3><p>You can evaluate some basic statistics like mean, median, and percentiles of each item in your batch results.</p><p>It is possible that parameter sets you used for your grid-search yield the same output movie (i.e. overlaps of (2, 2) and (3, 3) likely yield the same result).</p>", "a[href=\"#registration\"]": "<h1 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3. </span>Registration<a class=\"headerlink\" href=\"#registration\" title=\"Link to this heading\">#</a></h1><p>Correct for rigid/non-rigid movement</p>", "a[href=\"#with-only-2-batches-no-smoothing\"]": "<h5 class=\"tippy-header\" style=\"margin-top: 0;\">With only 2 batches, no smoothing<a class=\"headerlink\" href=\"#with-only-2-batches-no-smoothing\" title=\"Link to this heading\">#</a></h5><p>Now, show only the best 2 batch runs as determiend by residual optical flow without smoothing</p>", "a[href=\"#load-a-data-file-to-examine\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.1.2. </span>Load a data file to examine<a class=\"headerlink\" href=\"#load-a-data-file-to-examine\" title=\"Link to this heading\">#</a></h3>", "a[href=\"#preview-results-side-by-side-comparison\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.3.4. </span>Preview results: side-by-side comparison<a class=\"headerlink\" href=\"#preview-results-side-by-side-comparison\" title=\"Link to this heading\">#</a></h3><p><a class=\"reference external\" href=\"https://mesmerize-core.readthedocs.io/en/latest/api/mcorr.html\">See the mesmerize-core motion-correction (mcorr) API</a>.</p>", "a[href=\"#run-all-parameter-sets\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4.4. </span>Run all parameter sets<a class=\"headerlink\" href=\"#run-all-parameter-sets\" title=\"Link to this heading\">#</a></h3><p><code class=\"docutils literal notranslate\"><span class=\"pre\">df.iterrows()</span></code> iterates through rows and returns the numerical index and row for each iteration</p>", "a[href=\"#evaluate-results\"]": "<h2 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.5. </span>Evaluate results<a class=\"headerlink\" href=\"#evaluate-results\" title=\"Link to this heading\">#</a></h2><h3><span class=\"section-number\">3.5.1. </span>Summary statistics<a class=\"headerlink\" href=\"#summary-statistics\" title=\"Link to this heading\">#</a></h3><p>You can evaluate some basic statistics like mean, median, and percentiles of each item in your batch results.</p><p>It is possible that parameter sets you used for your grid-search yield the same output movie (i.e. overlaps of (2, 2) and (3, 3) likely yield the same result).</p>", "a[href=\"#evaluation-metrics\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.5.2. </span>Evaluation metrics<a class=\"headerlink\" href=\"#evaluation-metrics\" title=\"Link to this heading\">#</a></h3><p>Many of these metrics are related. <code class=\"docutils literal notranslate\"><span class=\"pre\">Norms</span></code> is a measure of the stregnth of <code class=\"docutils literal notranslate\"><span class=\"pre\">flows</span></code> (which also include direction). <code class=\"docutils literal notranslate\"><span class=\"pre\">Smoothness</span></code> measures sharpness of edges which typically result in high<code class=\"docutils literal notranslate\"><span class=\"pre\">correlations</span></code> because individual pixels are located in the same location.</p><p>For more a technical discussion on these metrics, see <a class=\"reference external\" href=\"https://www.sciencedirect.com/science/article/pii/S0165027017302753#sec0010\">NoRMCorre\u2019s companion paper</a> (section 2.2.1 - 2.2.4, 3.2.1 - 3.2.4).</p>", "a[href=\"#with-many-batches\"]": "<h5 class=\"tippy-header\" style=\"margin-top: 0;\">With many batches<a class=\"headerlink\" href=\"#with-many-batches\" title=\"Link to this heading\">#</a></h5>", "a[href=\"#reload-our-dataframe-if-you-made-a-mistake\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Reload our dataframe if you made a mistake<a class=\"headerlink\" href=\"#reload-our-dataframe-if-you-made-a-mistake\" title=\"Link to this heading\">#</a></h4>", "a[href=\"#use-can-also-your-own-grid-search-values\"]": "<h3 class=\"tippy-header\" style=\"margin-top: 0;\"><span class=\"section-number\">3.4.3. </span>Use can also your own grid-search values.<a class=\"headerlink\" href=\"#use-can-also-your-own-grid-search-values\" title=\"Link to this heading\">#</a></h3><p>For example:</p>", "a[href=\"#compute-batch-metrics\"]": "<h4 class=\"tippy-header\" style=\"margin-top: 0;\">Compute batch metrics<a class=\"headerlink\" href=\"#compute-batch-metrics\" title=\"Link to this heading\">#</a></h4><p>Feed your batch dataframe to <code class=\"docutils literal notranslate\"><span class=\"pre\">compute_batch_metrics</span></code> to compute each of these metrics and save them to disk.</p><p>This functiion will attempt to locate your raw data path to run evaluation metrics on the raw input-file for comparison.</p>"}
skip_classes = ["headerlink", "sd-stretched-link"]

window.onload = function () {
    for (const [select, tip_html] of Object.entries(selector_to_html)) {
        const links = document.querySelectorAll(` ${select}`);
        for (const link of links) {
            if (skip_classes.some(c => link.classList.contains(c))) {
                continue;
            }

            tippy(link, {
                content: tip_html,
                allowHTML: true,
                arrow: true,
                placement: 'auto-start', maxWidth: 500, interactive: false,

            });
        };
    };
    console.log("tippy tips loaded!");
};
